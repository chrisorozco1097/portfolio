import{highlightSearchTerm}from"./highlight-search-term.js";document.addEventListener("DOMContentLoaded",(function(){const filterItems=searchTerm=>{document.querySelectorAll(".bibliography, .unloaded").forEach((element=>element.classList.remove("unloaded")));if(CSS.highlights){const nonMatchingElements=highlightSearchTerm({search:searchTerm,selector:".bibliography > li"});if(nonMatchingElements==null){return}nonMatchingElements.forEach((element=>{element.classList.add("unloaded")}))}else{document.querySelectorAll(".bibliography > li").forEach(((element,index)=>{const text=element.innerText.toLowerCase();if(text.indexOf(searchTerm)==-1){element.classList.add("unloaded")}}))}document.querySelectorAll("h2.bibliography").forEach((function(element){let iterator=element.nextElementSibling;let hideFirstGroupingElement=true;while(iterator&&iterator.tagName!=="H2"){if(iterator.tagName==="OL"){const ol=iterator;const unloadedSiblings=ol.querySelectorAll(":scope > li.unloaded");const totalSiblings=ol.querySelectorAll(":scope > li");if(unloadedSiblings.length===totalSiblings.length){ol.previousElementSibling.classList.add("unloaded");ol.classList.add("unloaded")}else{hideFirstGroupingElement=false}}iterator=iterator.nextElementSibling}if(hideFirstGroupingElement){element.classList.add("unloaded")}}))};const updateInputField=()=>{const hashValue=decodeURIComponent(window.location.hash.substring(1));document.getElementById("bibsearch").value=hashValue;filterItems(hashValue)};let timeoutId;document.getElementById("bibsearch").addEventListener("input",(function(){clearTimeout(timeoutId);const searchTerm=this.value.toLowerCase();timeoutId=setTimeout(filterItems(searchTerm),300)}));window.addEventListener("hashchange",updateInputField);updateInputField()}));